<ng-container *ngIf="data$ | async as data">
  <header class="p-3 bg-dark text-white" *ngIf="isEdit">
    <div class="container">
      <div class="d-flex flex-wrap align-items-center justify-content-between">

        <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0">
          <li><a [routerLink]="['/projects']" class="nav-link px-2 text-secondary">Projects</a></li>
        </ul>

        <form [formGroup]="form" class="col-12 col-lg-auto d-flex">
          <ng-container *ngIf="form.value.editMode">
            <div class="mb-3 mb-lg-0 me-lg-3">
              <input
                (change)="rotationYChange()"
                type="number"
                class="form-control form-control-dark"
                formControlName="rotationY"
                step="0.1"
                min="0"
                max="6.3"
                placeholder="number" style="min-width: 100px;">
            </div>

            <div class="range-slider">
              <input class="range-slider__range"
                (input)="rotationYChange()"
                type="range"
                formControlName="rotationY"
                step="0.1"
                min="0"
                max="6.3">
              <span class="range-slider__value">{{ form.value.rotationY }}</span>
            </div>

            <div class="d-flex" *ngIf="form.value.editMode">
              <button type="button" class="btn btn-outline-light me-2" (click)="rotationYChange()">Edit</button>
              <button type="button" class="btn btn-outline-light me-2" (click)="saveY(data.project_id)">Save</button>
            </div>
          </ng-container>


          <div class="custom-control custom-switch" style="min-width: 115px;">
            <input type="checkbox" class="custom-control-input" id="editMode" formControlName="editMode" (change)="editModeSwitch()">
            <label class="custom-control-label" for="editMode">Edit mode</label>
          </div>
        </form>

      </div>
    </div>
  </header>
  <div class="vt-map">
    <div class="vt-map-point" *ngFor="let p of data.data; index as i"
    (click)="navTo(i)"
    [class.active]="activePoint === i"
    [style.top]="(p.panoramas.z * 30 ) + 50 + 'px'"
    [style.left]="(p.panoramas.x * 30) + 200 + 'px'">{{ i + 1 }}</div>
  </div>
  <div class="main-scene-wrapper">
    <canvas #virtualTour
    id="virtualTour"
    [propertyspacesVirtualTour]="data"
    (init)="vrInit()" (navigationChange)="changeActive($event)"></canvas>
  </div>
</ng-container>
